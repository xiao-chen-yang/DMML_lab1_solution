<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Solution | STATS5099 Data Mining and Machine Learning</title>
  <meta name="description" content="5 Solution | STATS5099 Data Mining and Machine Learning" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Solution | STATS5099 Data Mining and Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Solution | STATS5099 Data Mining and Machine Learning" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="optional-implementing-pca-using-prcomp.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to DMML Lab 1</a></li>
<li class="chapter" data-level="2" data-path="exercise-1-tasks-in-lecture-notes.html"><a href="exercise-1-tasks-in-lecture-notes.html"><i class="fa fa-check"></i><b>2</b> Exercise 1: Tasks in lecture notes</a></li>
<li class="chapter" data-level="3" data-path="exercise-2-employment-in-europe.html"><a href="exercise-2-employment-in-europe.html"><i class="fa fa-check"></i><b>3</b> Exercise 2: Employment in Europe</a></li>
<li class="chapter" data-level="4" data-path="optional-implementing-pca-using-prcomp.html"><a href="optional-implementing-pca-using-prcomp.html"><i class="fa fa-check"></i><b>4</b> Optional: Implementing PCA using <code>prcomp</code></a></li>
<li class="chapter" data-level="5" data-path="solution.html"><a href="solution.html"><i class="fa fa-check"></i><b>5</b> Solution</a>
<ul>
<li class="chapter" data-level="5.1" data-path="solution.html"><a href="solution.html#exercise-1"><i class="fa fa-check"></i><b>5.1</b> Exercise 1</a></li>
<li class="chapter" data-level="5.2" data-path="solution.html"><a href="solution.html#exercise-2"><i class="fa fa-check"></i><b>5.2</b> Exercise 2</a></li>
<li class="chapter" data-level="5.3" data-path="solution.html"><a href="solution.html#optional-implementing-pca-using-prcomp-1"><i class="fa fa-check"></i><b>5.3</b> Optional: Implementing PCA using <code>prcomp</code></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STATS5099 Data Mining and Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="solution" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Solution<a href="solution.html#solution" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="exercise-1" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Exercise 1<a href="solution.html#exercise-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Task 2. Looking at the Cumulative Proportion line we see:</p>
<ul>
<li><p>for 80% we would only need 5 components</p></li>
<li><p>for 95% we would need 10 components.</p></li>
</ul>
<p>Task 3. According to the new rule, we would obtain 6 components.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="solution.html#cb13-1" tabindex="-1"></a>wine.pca<span class="sc">$</span>sdevË†2<span class="sc">&gt;</span><span class="fl">0.6</span></span></code></pre></div>
<pre><code>## logical(0)</code></pre>
<p>Task 4. Although there are a large number of positive and negative non-zero loadings, the really dominant ones in terms of size (approximately 0.6) are ash and alcalinity of ash, so this component mainly seems to be interested in ash and its properties in wine.</p>
<p>Task 5. To calculate the first component score</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="solution.html#cb15-1" tabindex="-1"></a><span class="co">#By hand using R as a calculator</span></span>
<span id="cb15-2"><a href="solution.html#cb15-2" tabindex="-1"></a>new.x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="fl">0.4</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">600</span>),<span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb15-3"><a href="solution.html#cb15-3" tabindex="-1"></a><span class="fu">colnames</span>(new.x)<span class="ot">&lt;-</span><span class="fu">colnames</span>(wine.new)</span>
<span id="cb15-4"><a href="solution.html#cb15-4" tabindex="-1"></a>centre.wine<span class="ot">&lt;-</span>wine.pca<span class="sc">$</span>center</span>
<span id="cb15-5"><a href="solution.html#cb15-5" tabindex="-1"></a>scale.wine<span class="ot">&lt;-</span>wine.pca<span class="sc">$</span>scale</span>
<span id="cb15-6"><a href="solution.html#cb15-6" tabindex="-1"></a>first.load<span class="ot">&lt;-</span>wine.pca<span class="sc">$</span>loadings[,<span class="dv">1</span>]</span>
<span id="cb15-7"><a href="solution.html#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="solution.html#cb15-8" tabindex="-1"></a>new.x.cent<span class="ot">&lt;-</span>new.x<span class="sc">-</span>centre.wine</span>
<span id="cb15-9"><a href="solution.html#cb15-9" tabindex="-1"></a>new.x.stand<span class="ot">&lt;-</span>new.x.cent<span class="sc">/</span>scale.wine</span>
<span id="cb15-10"><a href="solution.html#cb15-10" tabindex="-1"></a>new.x.stand<span class="sc">%*%</span>first.load</span></code></pre></div>
<pre><code>##        [,1]
## [1,] -1.852</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="solution.html#cb17-1" tabindex="-1"></a><span class="co">#Using the predict command</span></span>
<span id="cb17-2"><a href="solution.html#cb17-2" tabindex="-1"></a><span class="fu">predict</span>(wine.pca,<span class="fu">as.data.frame</span>(new.x))</span></code></pre></div>
<pre><code>##      Comp.1 Comp.2 Comp.3  Comp.4  Comp.5 Comp.6  Comp.7 Comp.8 Comp.9 Comp.10
## [1,] -1.852 0.1965  -2.91 -0.2902 -0.5356  0.105 -0.4886 0.1793 -1.297 -0.7005
##      Comp.11 Comp.12 Comp.13
## [1,]  0.4829    0.16  0.7122</code></pre>
<p>We can see the answer by hand is the same as the first element of the <code>predict</code> result. If we were using PCA on the covariance matrix, we would skip the scaling stage (only centering before taking the inner product).</p>
</div>
<div id="exercise-2" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Exercise 2<a href="solution.html#exercise-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>The following codes produce some numerical summaries.</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="solution.html#cb19-1" tabindex="-1"></a><span class="co"># summary(employ)</span></span>
<span id="cb19-2"><a href="solution.html#cb19-2" tabindex="-1"></a><span class="fu">library</span>(skimr);<span class="fu">library</span>(knitr)</span>
<span id="cb19-3"><a href="solution.html#cb19-3" tabindex="-1"></a>my_skim <span class="ot">&lt;-</span> <span class="fu">skim_with</span>(<span class="at">base =</span> <span class="fu">sfl</span>(<span class="at">n =</span> length), <span class="at">numeric =</span> <span class="fu">sfl</span>(<span class="at">p0 =</span> <span class="cn">NULL</span>, <span class="at">p100 =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-4"><a href="solution.html#cb19-4" tabindex="-1"></a><span class="at">hist =</span> <span class="cn">NULL</span>))</span>
<span id="cb19-5"><a href="solution.html#cb19-5" tabindex="-1"></a><span class="fu">knit_print</span>(<span class="fu">my_skim</span>(employ))</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-17">Table 5.1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">employ</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">26</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">9</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">9</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AGRIC</td>
<td align="right">26</td>
<td align="right">19.13</td>
<td align="right">15.55</td>
<td align="right">7.70</td>
<td align="right">14.45</td>
<td align="right">23.67</td>
</tr>
<tr class="even">
<td align="left">MINING</td>
<td align="right">26</td>
<td align="right">1.25</td>
<td align="right">0.97</td>
<td align="right">0.52</td>
<td align="right">0.95</td>
<td align="right">1.80</td>
</tr>
<tr class="odd">
<td align="left">MANU</td>
<td align="right">26</td>
<td align="right">27.01</td>
<td align="right">7.01</td>
<td align="right">23.00</td>
<td align="right">27.55</td>
<td align="right">30.20</td>
</tr>
<tr class="even">
<td align="left">POWER</td>
<td align="right">26</td>
<td align="right">0.91</td>
<td align="right">0.38</td>
<td align="right">0.60</td>
<td align="right">0.85</td>
<td align="right">1.17</td>
</tr>
<tr class="odd">
<td align="left">CONSTR</td>
<td align="right">26</td>
<td align="right">8.17</td>
<td align="right">1.65</td>
<td align="right">7.53</td>
<td align="right">8.35</td>
<td align="right">8.97</td>
</tr>
<tr class="even">
<td align="left">SERVICE</td>
<td align="right">26</td>
<td align="right">12.96</td>
<td align="right">4.58</td>
<td align="right">9.25</td>
<td align="right">14.40</td>
<td align="right">16.88</td>
</tr>
<tr class="odd">
<td align="left">FINANCE</td>
<td align="right">26</td>
<td align="right">4.00</td>
<td align="right">2.81</td>
<td align="right">1.22</td>
<td align="right">4.65</td>
<td align="right">5.92</td>
</tr>
<tr class="even">
<td align="left">SOCIAL</td>
<td align="right">26</td>
<td align="right">20.02</td>
<td align="right">6.83</td>
<td align="right">16.25</td>
<td align="right">19.65</td>
<td align="right">24.12</td>
</tr>
<tr class="odd">
<td align="left">TRANS</td>
<td align="right">26</td>
<td align="right">6.55</td>
<td align="right">1.39</td>
<td align="right">5.70</td>
<td align="right">6.70</td>
<td align="right">7.07</td>
</tr>
</tbody>
</table>
<p>Comment: All variables are continuous variables, so it is suitable to apply PCA. The standard deviation vary across variables, which suggest that we should use the correlation matrix in PCA (This will be formally checked shortly).</p>
<p>The next step of exploratory analysis is to produce some graphical summaries. Here we could use the pairs plot in R.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="solution.html#cb20-1" tabindex="-1"></a><span class="co">#Look at the pairs plots for the data</span></span>
<span id="cb20-2"><a href="solution.html#cb20-2" tabindex="-1"></a><span class="fu">pairs</span>(employ,<span class="at">pch=</span><span class="dv">20</span>, <span class="at">lower.panel=</span><span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Comment: There are a couple of possible outliers. (We'll leave these for the moment and see if they appear again in our scores plot in the end for whether we need to re-run PCA without them included.) The data doesn't appear to fall into groups. There seem to be some linear relationships between pairs of variables but they are not very strong.</p>
<ol start="2" style="list-style-type: decimal">
<li>It's important to have a look at the correlation and variance of the variables.</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="solution.html#cb21-1" tabindex="-1"></a><span class="co">#Display the correlation matrix to 2 d.p.s</span></span>
<span id="cb21-2"><a href="solution.html#cb21-2" tabindex="-1"></a><span class="co">#library(matrixcalc)</span></span>
<span id="cb21-3"><a href="solution.html#cb21-3" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(employ),<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##         AGRIC MINING  MANU POWER CONSTR SERVICE FINANCE SOCIAL TRANS
## AGRIC    1.00   0.04 -0.67 -0.40  -0.54   -0.74   -0.22  -0.75 -0.56
## MINING   0.04   1.00  0.45  0.41  -0.03   -0.40   -0.44  -0.28  0.16
## MANU    -0.67   0.45  1.00  0.39   0.49    0.20   -0.16   0.15  0.35
## POWER   -0.40   0.41  0.39  1.00   0.06    0.20    0.11   0.13  0.38
## CONSTR  -0.54  -0.03  0.49  0.06   1.00    0.36    0.02   0.16  0.39
## SERVICE -0.74  -0.40  0.20  0.20   0.36    1.00    0.37   0.57  0.19
## FINANCE -0.22  -0.44 -0.16  0.11   0.02    0.37    1.00   0.11 -0.25
## SOCIAL  -0.75  -0.28  0.15  0.13   0.16    0.57    0.11   1.00  0.57
## TRANS   -0.56   0.16  0.35  0.38   0.39    0.19   -0.25   0.57  1.00</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="solution.html#cb23-1" tabindex="-1"></a><span class="co">#Look at the standard deviations of the variables</span></span>
<span id="cb23-2"><a href="solution.html#cb23-2" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">cov</span>(employ))),<span class="dv">1</span>)</span></code></pre></div>
<pre><code>##   AGRIC  MINING    MANU   POWER  CONSTR SERVICE FINANCE  SOCIAL   TRANS 
##    15.5     1.0     7.0     0.4     1.6     4.6     2.8     6.8     1.4</code></pre>
<p>Comment: There are some strong correlation (around -0.7) but a lot of weak (close to zero) correlations as well. It may be possible to achieve some dimension reduction here but not a lot. The variation for some variables is much bigger than for others, therefore we should use the correlation matrix and <em>not</em> the covariance matrix in PCA.</p>
<ol start="3" style="list-style-type: decimal">
<li>We should use <code>princomp</code> with the argument <code>cor=T</code> to perform PCA on the correlation matrix.</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="solution.html#cb25-1" tabindex="-1"></a>employ.pca<span class="ot">&lt;-</span><span class="fu">princomp</span>(employ,<span class="at">cor=</span>T)</span>
<span id="cb25-2"><a href="solution.html#cb25-2" tabindex="-1"></a>employ.pca</span></code></pre></div>
<pre><code>## Call:
## princomp(x = employ, cor = T)
## 
## Standard deviations:
##   Comp.1   Comp.2   Comp.3   Comp.4   Comp.5   Comp.6   Comp.7   Comp.8 
## 1.867392 1.459511 1.048312 0.997238 0.737033 0.619215 0.475136 0.369851 
##   Comp.9 
## 0.006755 
## 
##  9  variables and  26 observations.</code></pre>
<p>The <code>summary</code> function can give us information about how many components we should keep.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="solution.html#cb27-1" tabindex="-1"></a><span class="fu">summary</span>(employ.pca)</span></code></pre></div>
<pre><code>## Importance of components:
##                        Comp.1 Comp.2 Comp.3 Comp.4  Comp.5 Comp.6  Comp.7
## Standard deviation     1.8674 1.4595 1.0483 0.9972 0.73703 0.6192 0.47514
## Proportion of Variance 0.3875 0.2367 0.1221 0.1105 0.06036 0.0426 0.02508
## Cumulative Proportion  0.3875 0.6241 0.7463 0.8568 0.91711 0.9597 0.98480
##                        Comp.8    Comp.9
## Standard deviation     0.3699 6.755e-03
## Proportion of Variance 0.0152 5.069e-06
## Cumulative Proportion  1.0000 1.000e+00</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><p>Looking at the Cumulative Proportion line, it is clear that we need to keep 5 components to retain 90% variability.</p></li>
<li><p>For Cattell's method we will need to produce a scree plot.</p></li>
</ol>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="solution.html#cb29-1" tabindex="-1"></a><span class="fu">plot</span>(employ.pca)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-22-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>There are some different possibilities here, depending on how you read the graph. Suggesting 2, 4 or 6 components seems reasonable as that's where we see sudden drops/leveling off in variation.</p>
<ol start="6" style="list-style-type: decimal">
<li>For Kaiser's method we need to look at finding the average eigenvalue to discover which set of components have variation above it that we will retain.</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="solution.html#cb30-1" tabindex="-1"></a>employ.pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span><span class="sc">&gt;</span><span class="dv">1</span></span></code></pre></div>
<pre><code>## Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9 
##   TRUE   TRUE   TRUE  FALSE  FALSE  FALSE  FALSE  FALSE  FALSE</code></pre>
<p>Here we have cheated a bit, since we know the average variance is going to be <span class="math inline">\(1\)</span> whenever we use the correlation matrix. We can see that we would retain the first <span class="math inline">\(3\)</span> components in this case.</p>
<ol start="7" style="list-style-type: decimal">
<li>To interpret principal components, we look at the loadings from each component.</li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="solution.html#cb32-1" tabindex="-1"></a>employ.pca<span class="sc">$</span>loadings</span></code></pre></div>
<pre><code>## 
## Loadings:
##         Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9
## AGRIC    0.524                       0.213  0.153                0.806
## MINING          0.618 -0.201        -0.164 -0.101 -0.726              
## MANU    -0.347  0.355 -0.150 -0.346 -0.385 -0.288  0.479  0.126  0.366
## POWER   -0.256  0.261 -0.561  0.393  0.295  0.357  0.256 -0.341       
## CONSTR  -0.325         0.153 -0.668  0.472  0.130 -0.221 -0.356       
## SERVICE -0.379 -0.350 -0.115        -0.284  0.615 -0.229  0.388  0.238
## FINANCE        -0.454 -0.587         0.280 -0.526 -0.187  0.174  0.145
## SOCIAL  -0.387 -0.222  0.312  0.412 -0.220 -0.263 -0.191 -0.506  0.351
## TRANS   -0.367  0.203  0.375  0.314  0.513 -0.124         0.545       
## 
##                Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9
## SS loadings     1.000  1.000  1.000  1.000  1.000  1.000  1.000  1.000  1.000
## Proportion Var  0.111  0.111  0.111  0.111  0.111  0.111  0.111  0.111  0.111
## Cumulative Var  0.111  0.222  0.333  0.444  0.556  0.667  0.778  0.889  1.000</code></pre>
<ul>
<li><p>Component <span class="math inline">\(1\)</span> seems to be the difference between the average of manufacturing, power, construction, service, social and transporation industries, and the agricultural industry. So this new variable will distinguish between countries with agricultural economies and those with industrial economies.</p></li>
<li><p>Component <span class="math inline">\(2\)</span> seems to be the difference between the average of mining, manufacturing, power and transportation industries, and the average of service, finance and social industries. So this new variable distinguishes between contries with relatively large and relatively small service sectors.</p></li>
</ul>
<ol start="8" style="list-style-type: decimal">
<li>The scatterplot of scores for the first <span class="math inline">\(2\)</span> PCs is produced as follows.</li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="solution.html#cb34-1" tabindex="-1"></a>employ.scores2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(employ.pca<span class="sc">$</span>scores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb34-2"><a href="solution.html#cb34-2" tabindex="-1"></a><span class="fu">plot</span>(employ.scores2<span class="sc">$</span>Comp<span class="fl">.1</span>,employ.scores2<span class="sc">$</span>Comp<span class="fl">.2</span>,<span class="at">xlab=</span><span class="st">&quot;Comp.1&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Comp.2&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-25-1.png" width="576" /></p>
<p>There definitely seems to be an issue with at least one outlier. It would be worth identifying and removing it/them and re-running PCA to see if it affects the results.</p>
<ol start="9" style="list-style-type: decimal">
<li>We can calculate the scores using the following code</li>
</ol>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="solution.html#cb35-1" tabindex="-1"></a><span class="co">#By hand using R as a calculator</span></span>
<span id="cb35-2"><a href="solution.html#cb35-2" tabindex="-1"></a>centre.employ<span class="ot">&lt;-</span>employ.pca<span class="sc">$</span>center</span>
<span id="cb35-3"><a href="solution.html#cb35-3" tabindex="-1"></a>scale.employ<span class="ot">&lt;-</span>employ.pca<span class="sc">$</span>scale</span>
<span id="cb35-4"><a href="solution.html#cb35-4" tabindex="-1"></a>second.load<span class="ot">&lt;-</span>employ.pca<span class="sc">$</span>loadings[,<span class="dv">2</span>]</span>
<span id="cb35-5"><a href="solution.html#cb35-5" tabindex="-1"></a></span>
<span id="cb35-6"><a href="solution.html#cb35-6" tabindex="-1"></a>obs1.cent<span class="ot">&lt;-</span>obs1<span class="sc">-</span>centre.employ</span>
<span id="cb35-7"><a href="solution.html#cb35-7" tabindex="-1"></a>obs1.stand<span class="ot">&lt;-</span>obs1.cent<span class="sc">/</span>scale.employ</span>
<span id="cb35-8"><a href="solution.html#cb35-8" tabindex="-1"></a>obs1.stand<span class="sc">%*%</span>second.load</span></code></pre></div>
<pre><code>##         [,1]
## [1,] -0.7608</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="solution.html#cb37-1" tabindex="-1"></a>obs2.cent<span class="ot">&lt;-</span>obs2<span class="sc">-</span>centre.employ</span>
<span id="cb37-2"><a href="solution.html#cb37-2" tabindex="-1"></a>obs2.stand<span class="ot">&lt;-</span>obs2.cent<span class="sc">/</span>scale.employ</span>
<span id="cb37-3"><a href="solution.html#cb37-3" tabindex="-1"></a>obs2.stand<span class="sc">%*%</span>second.load</span></code></pre></div>
<pre><code>##        [,1]
## [1,] -1.373</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="solution.html#cb39-1" tabindex="-1"></a><span class="co">#Using the predict command</span></span>
<span id="cb39-2"><a href="solution.html#cb39-2" tabindex="-1"></a>newdata<span class="ot">&lt;-</span><span class="fu">rbind</span>(obs1,obs2);<span class="fu">colnames</span>(newdata)<span class="ot">&lt;-</span><span class="fu">colnames</span>(employ)</span>
<span id="cb39-3"><a href="solution.html#cb39-3" tabindex="-1"></a>new.data<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(newdata);</span>
<span id="cb39-4"><a href="solution.html#cb39-4" tabindex="-1"></a>new.data.scores<span class="ot">&lt;-</span><span class="fu">predict</span>(employ.pca,new.data)</span>
<span id="cb39-5"><a href="solution.html#cb39-5" tabindex="-1"></a>new.data.scores[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code></pre></div>
<pre><code>##      Comp.1  Comp.2   Comp.3   Comp.4   Comp.5   Comp.6
## obs1 -0.989 -0.7608 -0.01662 -0.46329 -0.80507  0.03885
## obs2 -1.468 -1.3729  0.70027  0.02475 -0.03189 -0.66059</code></pre>
</div>
<div id="optional-implementing-pca-using-prcomp-1" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Optional: Implementing PCA using <code>prcomp</code><a href="solution.html#optional-implementing-pca-using-prcomp-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following code uses <code>prcomp</code> to analyse the turtle data.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="solution.html#cb41-1" tabindex="-1"></a><span class="co">#Setting the random generator seed to ensure similar responses when re-running code</span></span>
<span id="cb41-2"><a href="solution.html#cb41-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">135</span>)</span>
<span id="cb41-3"><a href="solution.html#cb41-3" tabindex="-1"></a></span>
<span id="cb41-4"><a href="solution.html#cb41-4" tabindex="-1"></a><span class="do">#############################</span></span>
<span id="cb41-5"><a href="solution.html#cb41-5" tabindex="-1"></a><span class="co">#Principal Component Analysis</span></span>
<span id="cb41-6"><a href="solution.html#cb41-6" tabindex="-1"></a><span class="do">#############################</span></span>
<span id="cb41-7"><a href="solution.html#cb41-7" tabindex="-1"></a>pca.turt<span class="fl">.2</span><span class="ot">&lt;-</span><span class="fu">prcomp</span>(log.fem.turt[<span class="sc">-</span><span class="dv">10</span>,]);pca.turt<span class="fl">.2</span></span>
<span id="cb41-8"><a href="solution.html#cb41-8" tabindex="-1"></a></span>
<span id="cb41-9"><a href="solution.html#cb41-9" tabindex="-1"></a><span class="do">####################################</span></span>
<span id="cb41-10"><a href="solution.html#cb41-10" tabindex="-1"></a><span class="co">#Deciding on number of PCs to retain</span></span>
<span id="cb41-11"><a href="solution.html#cb41-11" tabindex="-1"></a><span class="do">####################################</span></span>
<span id="cb41-12"><a href="solution.html#cb41-12" tabindex="-1"></a><span class="fu">plot</span>(pca.turt<span class="fl">.2</span>);<span class="fu">summary</span>(pca.turt<span class="fl">.2</span>)</span>
<span id="cb41-13"><a href="solution.html#cb41-13" tabindex="-1"></a>sd.pca<span class="ot">&lt;-</span><span class="fu">summary</span>(pca.turt<span class="fl">.2</span>)<span class="sc">$</span>sdev</span>
<span id="cb41-14"><a href="solution.html#cb41-14" tabindex="-1"></a>tot.var<span class="ot">&lt;-</span><span class="fu">sum</span>(sd.pca<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb41-15"><a href="solution.html#cb41-15" tabindex="-1"></a>ave.var<span class="ot">&lt;-</span>tot.var<span class="sc">/</span><span class="fu">ncol</span>(log.fem.turt)</span>
<span id="cb41-16"><a href="solution.html#cb41-16" tabindex="-1"></a>ave.var</span>
<span id="cb41-17"><a href="solution.html#cb41-17" tabindex="-1"></a>sd.pca<span class="sc">^</span><span class="dv">2</span><span class="sc">&gt;</span>ave.var</span>
<span id="cb41-18"><a href="solution.html#cb41-18" tabindex="-1"></a></span>
<span id="cb41-19"><a href="solution.html#cb41-19" tabindex="-1"></a><span class="do">#######################################IT##############</span></span>
<span id="cb41-20"><a href="solution.html#cb41-20" tabindex="-1"></a><span class="co">#Interpreting the loadings and calculating new scores</span></span>
<span id="cb41-21"><a href="solution.html#cb41-21" tabindex="-1"></a><span class="do">#####################################################</span></span>
<span id="cb41-22"><a href="solution.html#cb41-22" tabindex="-1"></a>pca.turt<span class="fl">.2</span><span class="sc">$</span>rotation <span class="co">#loading matrix</span></span>
<span id="cb41-23"><a href="solution.html#cb41-23" tabindex="-1"></a><span class="co"># pca.turt.2$x #PC scores</span></span>
<span id="cb41-24"><a href="solution.html#cb41-24" tabindex="-1"></a>new.data<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">log.length=</span><span class="fu">c</span>(<span class="fl">4.8</span>),<span class="at">log.width=</span><span class="fu">c</span>(<span class="fl">4.7</span>),<span class="at">log.breadth=</span><span class="fu">c</span>(<span class="fl">3.9</span>))</span>
<span id="cb41-25"><a href="solution.html#cb41-25" tabindex="-1"></a><span class="fu">predict</span>(pca.turt<span class="fl">.2</span>,new.data)</span></code></pre></div>
<p>The PCA results using <code>princomp</code> and <code>prcomp</code> are not <em>too</em> different.</p>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="optional-implementing-pca-using-prcomp.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
